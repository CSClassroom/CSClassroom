function createCodeEditor(e,t,n,o){var l=ace.edit(e);if(l.setTheme("ace/theme/eclipse"),l.setShowPrintMargin(!1),l.setHighlightSelectedWord(!0),l.session.setMode("ace/mode/java"),l.session.setFoldStyle("manual"),l.session.setNewLineMode("windows"),l.setOptions({minLines:n,maxLines:o}),t){var i=function(){t.val(l.getSession().getValue())};i(),l.getSession().on("change",function(){i()})}}function rewriteGridCollectionNames(){$("input[id$='rowOrder']").each(function(e){var t=this.id.substring(0,this.id.indexOf("_")),n=this,o=this.form;$(o).validate({onsubmit:!1}),$(o).submit(function(e){return!!$(o).valid()&&($(o).find(":input").each(function(e){var o=this.id.indexOf(t),l=this.name.indexOf("["),i=this.name.indexOf("]");if(o>=0&&l>=0&&i>=0){var r=this.name.substring(l+1,i),a=$(n).val().split(",").indexOf(r);this.name=this.name.substring(0,l+1)+a+this.name.substring(i)}}),!0)})})}function keepAuthenticatedSessionAlive(e){var t,n=72e5,o=12,l=0,i="Session expired. Please copy your submission and refresh the page before making another submission.";t=function(){$.ajax({type:"GET",url:"/EnsureAuthenticated"}).done(function(){l++,l<o?setTimeout(t,n):alert(i)}).fail(function(){alert(i)})},setTimeout(t,n)}function getTableHtml(e,t){var n=!!e.childTableInfo,o=e.columns,l="";l+='<table class="display" align="left" cellpadding="5" cellspacing="0" border="2" width="auto">',l+=e.showHeader?"<thead>":'<thead style="display: none">',l+="<tr>",n&&(l+='<th style="min-width: 20px, max-width: 20px"></th>');for(var i=0;i<o.length;i++)l+="<th>"+o[i].text+"</th>";return l+="</tr>",l+="\t\t</thead>",l+="</table>"}function createFlatTable(e,t){if(e instanceof jQuery){var n=$(getTableHtml(t,!1));return e.append(n),n}return e.child(getTableHtml(t,!0)).show(),$(e.node()).next().find("table")}function createNestedTable(e,t,n,o,l){o||(o="No data available in table"),l||(l=[]);var i=t.columns,r=createFlatTable(e,t),a=[];t.childTableInfo&&a.push({className:"details-control",orderable:!1,data:null,defaultContent:""});for(var s=0;s<i.length;s++)a.push({data:i[s].name});var d=r.DataTable({data:n,columns:a,order:[[1,"asc"]],bFilter:!1,bInfo:!1,bPaginate:!1,bAutoWidth:!0,order:l,language:{emptyTable:o}});if(t.childTableInfo){var u=r.find("tbody");u.children("tr").children("td.details-control").each(function(e){var n=$(this).closest("tr"),o=d.row(n);o.data().childTableData?$(this).on("click",function(){o.child.isShown()?(n.next().children().first().remove(),o.child.hide(),n.removeClass("shown")):(createNestedTable(o,t.childTableInfo,o.data().childTableData),n.next().prepend($("<td></td>")),n.next().children().last().attr("colspan",3),n.addClass("shown"))}):n.children().first().attr("class","")})}}!function(e){function t(e,t){var n=null;return 1==e.length?(n=e.data("appendGrid"),n||t||alert(O.notInit)):t||alert(O.getValueMultiGrid),n}function n(t,n,o,r){var a,s,d,u,p=e(t).data("appendGrid"),h=[],f=null,w=[],b=t.getElementsByTagName("thead")[0],C=t.getElementsByTagName("tbody")[0],x=null,y=!1,O=!1,R=0,B=0;p.maxBodyHeight>0&&(b=e("#"+p._wrapperId+" table thead")[0]);var P=n,N=!1;if(e.isArray(n)&&(P=n.length,N=!0),e.isNumeric(r)){for(var S=0;S<p._rowOrder.length;S++)if(p._rowOrder[S]==r){o=S,0!=S&&(f=S-1);break}}else e.isNumeric(o)?o>=p._rowOrder.length?o=null:f=o-1:0!=p._rowOrder.length&&(o=null,f=p._rowOrder.length-1);p.maintainScroll&&!e.isNumeric(o)&&(R=e(t).height(),B=e(t).scrollParent().scrollTop()),0==p._rowOrder.length&&(e("tr.empty",t).remove(),O=!0);for(var S=0;S<P;S++){if(0<p.maxRowsAllowed&&p._rowOrder.length>=p.maxRowsAllowed){y=!0;break}p._uniqueIndex++,a=p._uniqueIndex,w.length=0,e.isNumeric(o)?(p._rowOrder.splice(o,0,a),p.useSubPanel?(C.insertBefore(x=document.createElement("tr"),C.childNodes[2*o]),C.insertBefore(d=document.createElement("tr"),C.childNodes[2*o])):C.insertBefore(d=document.createElement("tr"),C.childNodes[o]),h.push(o)):(p._rowOrder.push(a),C.appendChild(d=document.createElement("tr")),p.useSubPanel&&C.appendChild(x=document.createElement("tr")),h.push(p._rowOrder.length-1)),d.id=p.idPrefix+"_Row_"+a,p._sectionClasses.body&&(d.className=p._sectionClasses.body),e(d).data("appendGrid",a),null!=x&&(x.id=p.idPrefix+"_SubRow_"+a,e(x).data("appendGrid",a),p._sectionClasses.subPanel&&(x.className=p._sectionClasses.subPanel)),p.hideRowNumColumn||(d.appendChild(u=document.createElement("td")),e(u).addClass("ui-widget-content first").text(p._rowOrder.length),p.useSubPanel&&(u.rowSpan=2));for(var I=0;I<p.columns.length;I++)if("hidden"!=p.columns[I].type){var T="ui-widget-content";p.columns[I].invisible&&(T+=" invisible"),d.appendChild(u=document.createElement("td")),u.id=p.idPrefix+"_"+p.columns[I].name+"_td_"+a,u.className=T,null!=p.columns[I].cellCss&&e(u).css(p.columns[I].cellCss);var E,D=p.idPrefix+"_"+p.columns[I].name+"_"+a;if(E=e.isFunction(p.nameFormatter)?p.nameFormatter(p.idPrefix,p.columns[I].name,a):D,s=null,"custom"==p.columns[I].type)e.isFunction(p.columns[I].customBuilder)&&(s=p.columns[I].customBuilder(u,p.idPrefix,p.columns[I].name,a));else if("select"==p.columns[I].type||"ui-selectmenu"==p.columns[I].type){if(s=document.createElement("select"),s.id=D,s.name=E,e.isArray(p.columns[I].ctrlOptions)){if(p.columns[I].ctrlOptions.length>0)if(e.isPlainObject(p.columns[I].ctrlOptions[0]))for(var G=null,F=null,k=0;k<p.columns[I].ctrlOptions.length;k++){c(p.columns[I].ctrlOptions[k].group)?F=null:G!=p.columns[I].ctrlOptions[k].group&&(G=p.columns[I].ctrlOptions[k].group,F=document.createElement("optgroup"),F.label=G,s.appendChild(F));var L=e("<option/>").val(p.columns[I].ctrlOptions[k].value).text(p.columns[I].ctrlOptions[k].label);c(p.columns[I].ctrlOptions[k].title)||L.attr("title",p.columns[I].ctrlOptions[k].title),null==F?L.appendTo(s):L.appendTo(F)}else for(var k=0;k<p.columns[I].ctrlOptions.length;k++)s.options[s.options.length]=new Option(p.columns[I].ctrlOptions[k],p.columns[I].ctrlOptions[k])}else if(e.isPlainObject(p.columns[I].ctrlOptions))for(var k in p.columns[I].ctrlOptions)s.options[s.options.length]=new Option(p.columns[I].ctrlOptions[k],k);else if("string"==typeof p.columns[I].ctrlOptions)for(var A=p.columns[I].ctrlOptions.split(";"),k=0;k<A.length;k++){var q=A[k].indexOf(":");-1==q?s.options[s.options.length]=new Option(A[k],A[k]):s.options[s.options.length]=new Option(A[k].substring(q+1,A[k].length),A[k].substring(0,q))}else e.isFunction(p.columns[I].ctrlOptions)&&p.columns[I].ctrlOptions(s);u.appendChild(s),"ui-selectmenu"==p.columns[I].type&&e(s).selectmenu(p.columns[I].uiOption)}else if("checkbox"==p.columns[I].type)s=document.createElement("input"),s.type="checkbox",s.id=D,s.name=E,s.value=1,u.appendChild(s),u.style.textAlign="center";else if("textarea"==p.columns[I].type)s=document.createElement("textarea"),s.id=D,s.name=E,u.appendChild(s);else if(-1!=p.columns[I].type.search(/^(color|date|datetime|datetime\-local|email|month|number|range|search|tel|time|url|week)$/)){s=document.createElement("input");try{s.type=p.columns[I].type}catch(e){}s.id=D,s.name=E,u.appendChild(s)}else s=document.createElement("input"),s.type="text",s.id=D,s.name=E,u.appendChild(s),"ui-datepicker"==p.columns[I].type?e(s).datepicker(p.columns[I].uiOption):"ui-spinner"==p.columns[I].type?e(s).spinner(p.columns[I].uiOption):"ui-autocomplete"==p.columns[I].type&&e(s).autocomplete(p.columns[I].uiOption);"custom"!=p.columns[I].type&&(null!=p.columns[I].ctrlAttr&&e(s).attr(p.columns[I].ctrlAttr),null!=p.columns[I].ctrlProp&&e(s).prop(p.columns[I].ctrlProp),null!=p.columns[I].ctrlCss&&e(s).css(p.columns[I].ctrlCss),null!=p.columns[I].ctrlClass&&e(s).addClass(p.columns[I].ctrlClass),p.columns[I].uiTooltip&&e(s).tooltip(p.columns[I].uiTooltip),e.isFunction(p.columns[I].onClick)&&e(s).click({caller:t,callback:p.columns[I].onClick,uniqueIndex:a},function(t){t.data.callback(t,e(t.data.caller).appendGrid("getRowIndex",t.data.uniqueIndex))}),e.isFunction(p.columns[I].onChange)&&e(s).change({caller:t,callback:p.columns[I].onChange,uniqueIndex:a},function(t){t.data.callback(t,e(t.data.caller).appendGrid("getRowIndex",t.data.uniqueIndex))})),N?v(p,I,a,n[S][p.columns[I].name]):c(p.columns[I].value)||v(p,I,a,p.columns[I].value)}else w.push(I);if(!p._hideLastColumn||p.columns.length>p._visibleCount){if(p.rowButtonsInFront?p.hideRowNumColumn?d.insertBefore(u=document.createElement("td"),d.firstChild):d.insertBefore(u=document.createElement("td"),d.childNodes[1]):d.appendChild(u=document.createElement("td")),u.className="ui-widget-content last",p._hideLastColumn&&(u.style.display="none"),!p.hideButtons.insert){var H=_(p.customGridButtons.insert,"ui-icon-arrowreturnthick-1-w").attr({id:p.idPrefix+"_Insert_"+a,title:p._i18n.insert,tabindex:-1}).addClass("insert").data("appendGrid",{uniqueIndex:a}).click(function(n){var o=e(this).data("appendGrid").uniqueIndex;return e(t).appendGrid("insertRow",1,null,o),n&&n.preventDefault&&n.preventDefault(p._buttonClasses.insert),!1}).appendTo(u);c(p._buttonClasses.insert)||H.addClass(p._buttonClasses.insert)}if(!p.hideButtons.remove){var H=_(p.customGridButtons.remove,"ui-icon-trash").attr({id:p.idPrefix+"_Delete_"+a,title:p._i18n.remove,tabindex:-1}).addClass("remove").data("appendGrid",{uniqueIndex:a}).click(function(n){var o=e(this).data("appendGrid").uniqueIndex;return i(t,null,o,!1),n&&n.preventDefault&&n.preventDefault(),!1}).appendTo(u);c(p._buttonClasses.remove)||H.addClass(p._buttonClasses.remove)}if(!p.hideButtons.moveUp){var H=_(p.customGridButtons.moveUp,"ui-icon-arrowthick-1-n").attr({id:p.idPrefix+"_MoveUp_"+a,title:p._i18n.moveUp,tabindex:-1}).addClass("moveUp").data("appendGrid",{uniqueIndex:a}).click(function(n){var o=e(this).data("appendGrid").uniqueIndex;return e(t).appendGrid("moveUpRow",null,o),n&&n.preventDefault&&n.preventDefault(),!1}).appendTo(u);c(p._buttonClasses.moveUp)||H.addClass(p._buttonClasses.moveUp)}if(!p.hideButtons.moveDown){var H=_(p.customGridButtons.moveDown,"ui-icon-arrowthick-1-s").attr({id:p.idPrefix+"_MoveDown_"+a,title:p._i18n.moveDown,tabindex:-1}).addClass("moveDown").data("appendGrid",{uniqueIndex:a}).click(function(n){var o=e(this).data("appendGrid").uniqueIndex;return e(t).appendGrid("moveDownRow",null,o),n&&n.preventDefault&&n.preventDefault(),!1}).appendTo(u);c(p._buttonClasses.moveDown)||H.addClass(p._buttonClasses.moveDown)}if(p.rowDragging){var H=e("<div/>").addClass("rowDrag ui-state-default ui-corner-all").attr("title",p._i18n.rowDrag).append(e("<div/>").addClass("ui-icon ui-icon-carat-2-n-s").append(e("<span/>").addClass("ui-button-text").text("Drag"))).appendTo(u);c(p._buttonClasses.rowDrag)||H.addClass(p._buttonClasses.rowDrag)}for(var I=0;I<w.length;I++)s=document.createElement("input"),s.id=p.idPrefix+"_"+p.columns[w[I]].name+"_"+a,e.isFunction(p.nameFormatter)?s.name=p.nameFormatter(p.idPrefix,p.columns[I].name,a):s.name=s.id,s.type="hidden",N?s.value=n[S][p.columns[w[I]].name]:c(p.columns[w[I]].value)||(s.value=p.columns[w[I]].value),u.appendChild(s);if(p.customRowButtons&&p.customRowButtons.length){for(var I=p.customRowButtons.length-1;I>=0;I--){var U=p.customRowButtons[I];U&&U.uiButton&&U.click&&U.atTheFront&&e(u).prepend(l(t,U,a))}for(var I=0;I<p.customRowButtons.length;I++){var U=p.customRowButtons[I];U&&U.uiButton&&U.click&&!U.atTheFront&&e(u).append(l(t,U,a))}}}p.useSubPanel&&(x.appendChild(u=document.createElement("td")),u.className="ui-widget-content",u.colSpan=p._visibleCount+(p._hideLastColumn?0:1),e.isFunction(p.subPanelBuilder)&&p.subPanelBuilder(u,a))}if(0<p.maxBodyHeight&&p._calculateWidth&&!O){var j=e("#"+p._wrapperId+">div.scroller")[0];j.scrollHeight>j.offsetHeight&&(O=!0,p._calculateWidth=!1)}if(m(t,p),O&&p.autoColumnWidth&&p.maxBodyHeight>0&&g(document.getElementById(p._wrapperId)),e.isNumeric(o)?e.isFunction(p.afterRowInserted)&&p.afterRowInserted(t,f,h):e.isFunction(p.afterRowAppended)&&p.afterRowAppended(t,f,h),y&&e.isFunction(p.maxNumRowsReached)&&p.maxNumRowsReached(),p.maintainScroll&&!e.isNumeric(o)){var W=e(t).height();e(t).scrollParent().scrollTop(B+W-R)}return{addedRows:h,parentIndex:f,rowIndex:o}}function o(t,n){var o=e("<button/>").attr({type:"button",tabindex:-1}).button(n.uiButton).click({tbWhole:t},n.click);return n.btnClass&&o.addClass(n.btnClass),n.btnCss&&o.css(n.btnCss),n.btnAttr&&o.attr(n.btnAttr),o}function l(t,n,o){var l=e("<button/>").val(o).attr({type:"button",tabindex:-1}).button(n.uiButton).click({tbWhole:t,uniqueIndex:o},function(t){var o=e(t.data.tbWhole).appendGrid("getRowValue",null,t.data.uniqueIndex);n.click(t,t.data.uniqueIndex,o)});return n.btnClass&&l.addClass(n.btnClass),n.btnCss&&l.css(n.btnCss),n.btnAttr&&l.attr(n.btnAttr),l}function i(t,n,o,l){var i=e(t).data("appendGrid"),a=t.getElementsByTagName("tbody")[0];if(e.isNumeric(o))for(var d=0;d<i._rowOrder.length;d++)if(i._rowOrder[d]==o){n=d;break}if(e.isNumeric(n))(l||"function"!=typeof i.beforeRowRemove||i.beforeRowRemove(t,n))&&(i._rowOrder.splice(n,1),i.useSubPanel?(a.removeChild(a.childNodes[2*n]),a.removeChild(a.childNodes[2*n])):a.removeChild(a.childNodes[n]),m(t,i),s(t,n),e.isFunction(i.afterRowRemoved)&&i.afterRowRemoved(t,n));else{var u=0,c=0;if(i.maintainScroll&&(u=e(t).height(),c=e(t).scrollParent().scrollTop()),(l||!e.isFunction(i.beforeRowRemove)||i.beforeRowRemove(t,i._rowOrder.length-1))&&(o=i._rowOrder.pop(),a.removeChild(a.lastChild),i.useSubPanel&&a.removeChild(a.lastChild),m(t,i),e.isFunction(i.afterRowRemoved)&&i.afterRowRemoved(t,null)),i.maintainScroll){var p=e(t).height();e(t).scrollParent().scrollTop(c+p-u)}}0==i._rowOrder.length&&r(document.getElementById(i._wrapperId),i)}function r(t,n,o){var l=e("<td></td>").text(n._i18n.rowEmpty).attr("colspan",n._finalColSpan);e("table.body tbody",t).append(e("<tr></tr>").addClass("empty").append(l)),!o&&n.maxBodyHeight>0&&(n.autoColumnWidth?g(t):l.width(e("table.head",t).width()-4))}function a(t){var n=e(t).data("appendGrid");e("tbody",t).empty(),n._rowOrder.length=0,n._uniqueIndex=0,m(t,n),r(document.getElementById(n._wrapperId),n)}function s(t,n){var o=e(t).data("appendGrid");if(!o.hideRowNumColumn)for(var l=n;l<o._rowOrder.length;l++)e("#"+o.idPrefix+"_Row_"+o._rowOrder[l]+" td.first",t).text(l+1)}function d(t,o,l){var i,r,a=e(t).data("appendGrid");if(a){if(i=t.getElementsByTagName("tbody")[0],e(i).empty(),a._rowOrder.length=0,a._uniqueIndex=0,null!=o&&o.length){r=n(t,o.length,null,null);for(var s=0;s<r.addedRows.length;s++){for(var d=0;d<a.columns.length;d++)v(a,d,a._rowOrder[s],o[s][a.columns[d].name]);e.isFunction(a.rowDataLoaded)&&a.rowDataLoaded(t,o[s],s,a._rowOrder[s])}}a._isDataLoaded=!0,l&&(a.initData=null),e(t).data("appendGrid",a),e.isFunction(a.dataLoaded)&&a.dataLoaded(t,o)}}function u(e,t){for(var n=0;n<t._rowOrder.length;n++)if(t._rowOrder[n]==e)return n;return null}function c(e){return"undefined"==typeof e||null==e}function m(t,n){e(t).data("appendGrid",n),e("#"+n.idPrefix+"_rowOrder",t).val(n._rowOrder.join())}function p(t,n,o){for(var l={},i=null,r=c(o)?"":"_"+o,a=0;a<t.columns.length;a++)i=t.columns[a].name+r,l[i]=h(t,a,n);if(t.useSubPanel&&e.isFunction(t.subPanelGetter)){var s=t.subPanelGetter(n);if(e.isPlainObject(s))if(""==r)e.extend(l,s);else{var d={};for(var u in s)d[u+r]=s[u];e.extend(l,d)}}return l}function h(t,n,o){var l=null,i=t.columns[n].type,r=t.columns[n].name;return"checkbox"==i?(l=f(i,t.idPrefix,r,o),null==l?null:l.checked?1:0):"custom"==i?e.isFunction(t.columns[n].customGetter)?t.columns[n].customGetter(t.idPrefix,r,o):null:(l=f(i,t.idPrefix,r,o),null==l?null:l.value)}function f(e,t,n,o){return document.getElementById(t+"_"+n+"_"+o)}function v(t,n,o,l){var i=t.columns[n].type,r=t.columns[n].name;if("checkbox"==i)f(i,t.idPrefix,r,o).checked=null!=l&&0!=l;else if("custom"==i)e.isFunction(t.columns[n].customSetter)&&t.columns[n].customSetter(t.idPrefix,r,o,l);else if("ui-selectmenu"==i){var a=f(i,t.idPrefix,r,o);a.value=null==l?"":l,e(a).selectmenu("refresh")}else f(i,t.idPrefix,r,o).value=null==l?"":l}function w(t,n,o,l){for(var i=e(t).data("appendGrid"),r=-1,a=0;a<i._rowOrder.length;a++)if(i._rowOrder[a]==o){n?(r=l,i._rowOrder.splice(a,1),i._rowOrder.splice(l,0,o)):(r=a,i._rowOrder.splice(l+1,0,o),i._rowOrder.splice(a,1));break}s(t,r),m(t,i),e.isFunction(i.afterRowDragged)&&i.afterRowDragged(t,l,o)}function _(t,n){var o=null;return t&&(e.isFunction(t)?o=e(t()):t.nodeType?o=e(t).clone():t.icons&&(o=e("<button/>").attr({type:"button"}).button(t))),o||(o=e("<button/>").attr({type:"button"}).button({icons:{primary:n},text:!1})),o}function b(t,n){for(var o=0;o<t.columns.length;o++){var l=t._rowOrder[n],i=h(t,o,l);if(e.isFunction(t.columns[o].emptyCriteria)){if(!t.columns[o].emptyCriteria(i))return!1}else{var r=null;if(c(t.columns[o].emptyCriteria))if("checkbox"==t.columns[o].type)r=0;else if("select"==t.columns[o].type||"ui-selectmenu"==t.columns[o].type){var a=f(t.columns[o].type,t.idPrefix,t.columns[o].name,l).options;r=a.length>0?a[0].value:""}else r="";else r=t.columns[o].emptyCriteria;if(i!=r)return!1}}return!0}function g(t){var n=e("table.body",t),o=e("div.scroller",t),l=n.data("appendGrid"),i=e("table.head tr.columnHead",t)[0],r=e("table.body colgroup",t)[0];if(l._rowOrder.length>0){e("td",i).width("auto"),e("col",r).width("auto"),n.width("auto"),o.width("auto");var a=e("tbody tr",n)[0];if(i.childNodes.length==a.childNodes.length){var s=-2;e.fn.modal&&(s=1);for(var d=0;d<a.childNodes.length;d++){var u=i.childNodes[d].clientWidth+1,c=a.childNodes[d].clientWidth+s;c>u?i.childNodes[d].style.width=c+"px":r.childNodes[d].style.width=u+"px"}}}else e("table.body,table.foot",t).width(e("table.head").width());e("table.foot",t).width(n.width()),o.width(n.width()+o[0].offsetWidth-o[0].clientWidth+1)}var C={caption:null,captionTooltip:null,initRows:3,maxRowsAllowed:0,initData:null,columns:null,i18n:null,idPrefix:null,rowDragging:!1,hideButtons:null,hideRowNumColumn:!1,rowButtonsInFront:!1,rowCountName:"_RowCount",buttonClasses:null,sectionClasses:null,customGridButtons:null,customRowButtons:null,customFooterButtons:null,useSubPanel:!1,maintainScroll:!1,maxBodyHeight:0,autoColumnWidth:!0},x={nameFormatter:null,dataLoaded:null,rowDataLoaded:null,afterRowAppended:null,afterRowInserted:null,afterRowSwapped:null,beforeRowRemove:null,afterRowRemoved:null,afterRowDragged:null,subPanelBuilder:null,subPanelGetter:null,maxNumRowsReached:null},y={type:"text",name:null,value:null,display:null,displayCss:null,displayTooltip:null,headerSpan:1,cellCss:null,ctrlAttr:null,ctrlProp:null,ctrlCss:null,ctrlClass:null,ctrlOptions:null,uiOption:null,uiTooltip:null,resizable:!1,invisible:!1,emptyCriteria:null,customBuilder:null,customGetter:null,customSetter:null,onClick:null,onChange:null},O={noColumnInfo:"Cannot initial grid without column information!",elemNotTable:"Cannot initial grid on element other than TABLE!",notInit:"`appendGrid` does not initialized",getValueMultiGrid:"Cannot get values on multiple grid",notSupportMethod:"Method is not supported by `appendGrid`: "},R={append:"Append Row",removeLast:"Remove Last Row",insert:"Insert Row Above",remove:"Remove Current Row",moveUp:"Move Up",moveDown:"Move Down",rowDrag:"Sort Row",rowEmpty:"This Grid Is Empty"},B={append:null,removeLast:null,insert:null,remove:null,moveUp:null,moveDown:null,rowDrag:null},P={caption:null,header:null,body:null,subPanel:null,footer:null},N={append:!1,removeLast:!1,insert:!1,remove:!1,moveUp:!1,moveDown:!1},S={init:function(t){var l=this;if(l.length>0){if(!e.isArray(t.columns)||0==t.columns.length)return alert(O.noColumnInfo),l;var a,s,u,m,p,h,f,v=l[0];if(c(v.tagName)||"TABLE"!=v.tagName)return alert(O.elemNotTable),l;var b=e.extend({},C,x,t);e.extend(b,{_uniqueIndex:0,_rowOrder:[],_isDataLoaded:!1,_visibleCount:0,_finalColSpan:0,_hideLastColumn:!1,_wrapperId:null,_calculateWidth:!0}),e.isPlainObject(t.i18n)?b._i18n=e.extend({},R,t.i18n):b._i18n=e.extend({},R),e.isPlainObject(t.buttonClasses)?b._buttonClasses=e.extend({},B,t.buttonClasses):b._buttonClasses=e.extend({},B),e.isPlainObject(t.sectionClasses)?b._sectionClasses=e.extend({},P,t.sectionClasses):b._sectionClasses=e.extend({},P),e.isPlainObject(t.hideButtons)?b.hideButtons=e.extend({},N,t.hideButtons):b.hideButtons=e.extend({},N),c(b.idPrefix)&&(c(v.id)||""==v.id?b.idPrefix="ag"+(new Date).getTime():b.idPrefix=v.id),e.isPlainObject(b.customGridButtons)||(b.customGridButtons={}),b.useSubPanel&&b.rowDragging&&(b.rowDragging=!1),s=document.createElement("thead"),s.className="ui-widget-header",u=document.createElement("tbody"),u.className="ui-widget-content",m=document.createElement("tfoot"),m.className="ui-widget-header",p=document.createElement("colgroup"),b._wrapperId=b.idPrefix+"-wrapper",a=document.createElement("div"),e(a).attr("id",b._wrapperId).addClass("appendGrid").insertAfter(v),e(v).empty().addClass("ui-widget").appendTo(a),b.maxBodyHeight>0?(e("<table></table>").addClass("ui-widget head").append(s).prependTo(a),e(v).addClass("body").wrap(e("<div></div>").addClass("scroller").css("max-height",b.maxBodyHeight)).append(p,u),e("<table></table>").addClass("ui-widget foot").append(m).appendTo(a)):e(v).addClass("head body foot").append(p,s,u,m);var S,I;s.appendChild(h=document.createElement("tr")),b._sectionClasses.header?h.className="columnHead "+b._sectionClasses.header:h.className="columnHead",b.hideRowNumColumn||(h.appendChild(S=document.createElement("td")),S.className="ui-widget-header first",p.appendChild(document.createElement("col")));for(var T=0,E=0;E<b.columns.length;E++){var D=e.extend({},y,b.columns[E]);if(b.columns[E]=D,"hidden"!=b.columns[E].type)if(b.columns[E].invisible||b._visibleCount++,0==T){var G="ui-widget-header";b.columns[E].invisible&&(G+=" invisible"),b.columns[E].resizable&&(G+=" resizable"),h.appendChild(f=document.createElement("td")),f.id=b.idPrefix+"_"+b.columns[E].name+"_td_head",f.className=G,b.columns[E].displayCss&&e(f).css(b.columns[E].displayCss),b.columns[E].headerSpan>1&&(e(f).attr("colSpan",b.columns[E].headerSpan),T=b.columns[E].headerSpan-1),e.isPlainObject(b.columns[E].displayTooltip)?e(f).tooltip(b.columns[E].displayTooltip):c(b.columns[E].displayTooltip)||e(f).attr("title",b.columns[E].displayTooltip).tooltip(),e.isFunction(b.columns[E].display)?b.columns[E].display(f):c(b.columns[E].display)||e(f).text(b.columns[E].display),p.appendChild(document.createElement("col"))}else T--}if(c(jQuery.ui.resizable)||e("td.resizable",s).resizable({handles:"e"}),b.hideButtons.insert&&b.hideButtons.remove&&b.hideButtons.moveUp&&b.hideButtons.moveDown&&(!e.isArray(b.customRowButtons)||0==b.customRowButtons.length)&&(b._hideLastColumn=!0),b._finalColSpan=b._visibleCount,b.hideRowNumColumn||b._finalColSpan++,b._hideLastColumn||b._finalColSpan++,b._hideLastColumn||(b.rowButtonsInFront?b.hideRowNumColumn?h.insertBefore(I=document.createElement("td"),h.firstChild):h.insertBefore(I=document.createElement("td"),h.childnodes[1]):h.appendChild(I=document.createElement("td")),I.className="ui-widget-header last",p.appendChild(document.createElement("col"))),b.caption&&(s.insertBefore(h=document.createElement("tr"),s.firstChild),b._sectionClasses.caption&&(h.className=b._sectionClasses.caption),h.appendChild(f=document.createElement("td")),f.id=b.idPrefix+"_caption_td",f.className="ui-state-active caption",f.colSpan=b._finalColSpan,e.isPlainObject(b.captionTooltip)?e(f).tooltip(b.captionTooltip):c(b.captionTooltip)||e(f).attr("title",b.captionTooltip).tooltip(),e.isFunction(b.caption)?b.caption(f):e(f).text(b.caption)),m.appendChild(h=document.createElement("tr")),b._sectionClasses.footer&&(h.className=b._sectionClasses.footer),h.appendChild(f=document.createElement("td")),f.id=b.idPrefix+"_footer_td",f.colSpan=b._finalColSpan,e("<input/>").attr({type:"hidden",id:b.idPrefix+"_rowOrder",name:b.idPrefix+"_rowOrder"}).appendTo(f),!b.hideButtons.append||!b.hideButtons.removeLast||e.isArray(b.customFooterButtons)&&0!=b.customFooterButtons.length){if(!b.hideButtons.append){var F=_(b.customGridButtons.append,"ui-icon-plusthick").attr({title:b._i18n.append}).addClass("append").click(function(e){return n(v,1,null,null),e&&e.preventDefault&&e.preventDefault(),!1}).appendTo(f);c(b._buttonClasses.append)||F.addClass(b._buttonClasses.append)}if(!b.hideButtons.removeLast){var F=_(b.customGridButtons.removeLast,"ui-icon-closethick").attr({title:b._i18n.removeLast}).addClass("removeLast").click(function(e){return i(v,null,this.value,!1),e&&e.preventDefault&&e.preventDefault(),!1}).appendTo(f);c(b._buttonClasses.removeLast)||F.addClass(b._buttonClasses.removeLast)}if(b.customFooterButtons&&b.customFooterButtons.length){for(var k=b.customFooterButtons.length-1;k>=0;k--){var L=b.customFooterButtons[k];L&&L.uiButton&&L.click&&L.atTheFront&&e(f).prepend(o(v,L))}for(var k=0;k<b.customFooterButtons.length;k++){var L=b.customFooterButtons[k];L&&L.uiButton&&L.click&&!L.atTheFront&&e(f).append(o(v,L))}}}else h.style.display="none";b.rowDragging&&e(u).sortable({axis:"y",containment:v,handle:".rowDrag",helper:function(t,n){var o=n.children(),l=n.clone();return l.children().each(function(t){e(this).width(o.eq(t).width());var n=e("select",this);if(n.length>0)for(var l=0;l<n.length;l++){var i=o.eq(t).find("select");i.length>l&&(n[l].value=i[l].value)}}),l},update:function(t,n){var o=n.item[0].id.substring(n.item[0].id.lastIndexOf("_")+1),l=n.item[0].rowIndex-e("tr",s).length;w(v,n.originalPosition.top>n.position.top,o,l)}}),e(v).data("appendGrid",b),e.isArray(t.initData)?d(v,t.initData,!0):e(v).appendGrid("appendRow",b.initRows),0==b._rowOrder.length&&r(a,b,!0),b.maxBodyHeight>0&&(b.autoColumnWidth?g(a):e("table.foot",a).width(e(v).width()))}return l},isReady:function(){var e=t(this,!0);return!!e},isDataLoaded:function(){var e=t(this);return!!e&&e._isDataLoaded},load:function(e){var n=t(this),o=this;return n&&(null!=e&&e.length>0?d(o[0],e,!1):a(o[0])),o},appendRow:function(e){return this.appendGrid("insertRow",e)},insertRow:function(o,l,i){var r=t(this);if(r&&(e.isArray(o)&&o.length>0||e.isNumeric(o)&&o>0)){var a=this[0];if(insertResult=n(a,o,l,i),e.isNumeric(l)||e.isNumeric(i)){s(a,insertResult.rowIndex);var d=r._rowOrder[insertResult.addedRows[0]];e("#"+r.idPrefix+"_Insert_"+d,a).focus()}}return this},removeRow:function(e,n){var o=t(this);return o&&o._rowOrder.length>0&&i(this[0],e,n,!0),this},emptyGrid:function(){var e=t(this);return e&&a(this[0]),target},moveUpRow:function(n,o){var l=t(this),i=this;if(l){var r,a,s,d,c=i[0],p=null,h=c.getElementsByTagName("tbody")[0];e.isNumeric(n)&&n>0&&n<l._rowOrder.length?(p=n,o=l._rowOrder[n]):e.isNumeric(o)&&(p=u(o,l)),null!=p&&p>0&&(r=document.getElementById(l.idPrefix+"_Row_"+o,c),a=document.getElementById(l.idPrefix+"_Row_"+l._rowOrder[p-1],c),l.useSubPanel&&(s=document.getElementById(l.idPrefix+"_SubRow_"+o,c)),h.removeChild(r),l.useSubPanel&&h.removeChild(s),h.insertBefore(r,a),l.useSubPanel&&h.insertBefore(s,a),l._rowOrder[p]=l._rowOrder[p-1],l._rowOrder[p-1]=o,d=e("td.first",a).html(),e("td.first",a).html(e("td.first",r).html()),e("td.first",r).html(d),m(c,l),e("td.last button.moveUp",r).removeClass("ui-state-hover").blur(),e("td.last button.moveUp",a).focus(),l.afterRowSwapped&&l.afterRowSwapped(c,p,p-1))}return i},moveDownRow:function(n,o){var l=t(this),i=this;if(l){var r,a,s,d,c=i[0],p=null,h=c.getElementsByTagName("tbody")[0];e.isNumeric(n)&&n>=0&&n<l._rowOrder.length-1?(p=n,o=l._rowOrder[n]):e.isNumeric(o)&&(p=u(o,l)),null!=p&&p!=l._rowOrder.length-1&&(r=document.getElementById(l.idPrefix+"_Row_"+o,c),a=document.getElementById(l.idPrefix+"_Row_"+l._rowOrder[p+1],c),l.useSubPanel&&(s=document.getElementById(l.idPrefix+"_SubRow_"+l._rowOrder[p+1],c)),h.removeChild(a),h.insertBefore(a,r),l.useSubPanel&&h.insertBefore(s,r),l._rowOrder[p]=l._rowOrder[p+1],l._rowOrder[p+1]=o,d=e("td.first",a).html(),e("td.first",a).html(e("td.first",r).html()),e("td.first",r).html(d),m(c,l),e("td.last button.moveDown",r).removeClass("ui-state-hover").blur(),e("td.last button.moveDown",a).focus(),l.afterRowSwapped&&l.afterRowSwapped(c,p,p+1))}return i},showColumn:function(n){var o=t(this);if(o&&n){for(var l=-1,i=this[0],r=0;r<o.columns.length;r++)if(o.columns[r].name==n){l=r;break}if(l!=-1&&o.columns[l].invisible){o._visibleCount++,o._finalColSpan++,e("#"+o.idPrefix+"_caption_td").attr("colSpan",o._finalColSpan),e("#"+o.idPrefix+"_footer_td").attr("colSpan",o._finalColSpan),e("#"+o.idPrefix+"_"+n+"_td_head").removeClass("invisible");for(var r=0;r<o._rowOrder.length;r++){var a=o._rowOrder[r];e("#"+o.idPrefix+"_"+n+"_td_"+a).removeClass("invisible"),o.useSubPanel&&e("#"+o.idPrefix+"_SubRow_"+a).attr("colSpan",o._visibleCount+(o._hideLastColumn?0:1))}o.columns[l].invisible=!1,m(i,o)}}return this},hideColumn:function(n){var o=t(this);if(o&&n){for(var l=-1,i=this[0],r=0;r<o.columns.length;r++)if(o.columns[r].name==n){l=r;break}if(l!=-1&&!o.columns[l].invisible){o._visibleCount--,o._finalColSpan--,e("#"+o.idPrefix+"_caption_td").attr("colSpan",o._finalColSpan),e("#"+o.idPrefix+"_footer_td").attr("colSpan",o._finalColSpan),e("#"+o.idPrefix+"_"+n+"_td_head").addClass("invisible");for(var r=0;r<o._rowOrder.length;r++){var a=o._rowOrder[r];e("#"+o.idPrefix+"_"+n+"_td_"+a).addClass("invisible"),o.useSubPanel&&e("#"+o.idPrefix+"_SubRow_"+a).attr("colSpan",o._visibleCount+(o._hideLastColumn?0:1))}o.columns[l].invisible=!0,m(i,o)}}return this},isColumnInvisible:function(e){var n=t(this);if(n&&e)for(var o=0;o<n.columns.length;o++)if(n.columns[o].name==e)return n.columns[o].invisible;return null},getRowCount:function(){var e=t(this);return e?e._rowOrder.length:null},getUniqueIndex:function(n){var o=t(this);return o&&e.isNumeric(n)&&n<o._rowOrder.length?o._rowOrder[n]:null},getRowIndex:function(n){var o=t(this);if(o&&e.isNumeric(n))for(var l=0;l<o._rowOrder.length;l++)if(o._rowOrder[l]==n)return l;return null},getRowValue:function(n,o,l){var i=t(this),r=null;return i&&(e.isNumeric(n)&&n>=0&&n<i._rowOrder.length&&(o=i._rowOrder[n]),c(o)||(r=p(i,o,l))),r},getAllValue:function(n){var o=t(this),l=null;if(o){l=n?{}:[];for(var i=0;i<o._rowOrder.length;i++)n?(rowValue=p(o,o._rowOrder[i],i),e.extend(l,rowValue)):(rowValue=p(o,o._rowOrder[i]),l.push(rowValue));n&&(l[o.rowCountName]=o._rowOrder.length)}return l},getCtrlValue:function(e,n){var o=t(this);if(o&&n>=0&&n<o._rowOrder.length)for(var l=0;l<o.columns.length;l++)if(o.columns[l].name===e)return h(o,l,o._rowOrder[n]);return null},setCtrlValue:function(e,n,o){var l=t(this);if(l&&n>=0&&n<l._rowOrder.length)for(var i=0;i<l.columns.length;i++)if(l.columns[i].name==e){v(l,i,l._rowOrder[n],o);break}return this},getCellCtrl:function(e,n){var o=t(this);if(o&&n>=0&&n<o._rowOrder.length)for(var l=o._rowOrder[n],i=0;i<o.columns.length;i++)if(o.columns[i].name===e)return f(o.columns[i].type,o.idPrefix,e,l);return null},getCellCtrlByUniqueIndex:function(e,n){var o=t(this);if(o)for(var l=0;l<o.columns.length;l++)if(o.columns[l].name===e)return f(o.columns[l].type,o.idPrefix,e,n);return null},getRowOrder:function(){var e=t(this);return e?e._rowOrder.slice():null},getColumns:function(){var e=t(this);return e?e.columns.slice():null},isRowEmpty:function(e){var n=t(this);return n?b(n,e):null},removeEmptyRows:function(){var e=t(this);if(e){for(var n=this[0],o=e._rowOrder.length;o>=0;o--)b(e,o)&&i(n,null,e._rowOrder[o],!0);return this}return null}};e.fn.appendGrid=function(e){return S[e]?S[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void alert(O.notSupportMethod+e):S.init.apply(this,arguments)}}(jQuery);